define("ds2-content-navigation-tron-tracking",[],(function(){return function(){var e={579:function(e,t,n){"use strict";n.r(t),n.d(t,{getDataLayerFromApi:function(){return o},getDataLayerFromSources:function(){return i},extractFrmPageDL:function(){return r},getDL:function(){return s},evaluateDLPath:function(){return c},datalayerPath:function(){return g},getFirstFunctionWithValue:function(){return p},gFFWNV:function(){return l},determineBrand:function(){return d},buildPageObj:function(){return m},convertToACDL:function(){return v}}),window.TRON=window.TRON||{},TRON.isInitialized||function(){var e=console.error,t=console.info,n=console.warn;function a(){return-1!=document.location.search.indexOf("trondebug=true")||null!=sessionStorage.getItem("tronDebug")&&"true"===sessionStorage.getItem("tronDebug")}console.error=function(){if("object"==typeof arguments[0]&&(arguments[0]=arguments[0].toString()),void 0!==arguments[0]&&arguments[0].indexOf("Incorrect TRON implementation: ⛔")>-1){var t=arguments[0].split("Incorrect TRON implementation: ⛔")[1],n={E001:"parameter is missing",E002:"value is incorrect",E003:"value is empty",E004:"does not exist"},o=Object.entries(n).find((([e,n])=>t.includes(n)));o=o?o[0]:"Unknown error",window.adobeDataLayer=window.adobeDataLayer||[];let e=TRON.dataComponent;var i="undefined"!=typeof prefix?prefix:TRON.prefix,r={"con >":"configurator","stock >":"stock locator","sales >":"sales","fin >":"finance","rent >":"rental"},s=void 0!==r[i]?r[i]:((((this.message||"").component||"")[0]||"").category||"").primaryCategory||"";if(""==s||"shared > "==i||"local > "==i){var c=[".bmw.",".mini.",".bmw-motorrad.",".bmwusa.com","customer.bmwgroup.com"],g=c.some((e=>window.location.href.includes(e)));if(g)if([".bmw.com"].some((e=>window.location.href.includes(e)))){var p=window.location.pathname.split("/");void 0!==p[1]&&"nsc website"==(s=p[1].indexOf("-")>-1?"nsc website":"special website")&&(i="nsc > ")}else s="special website",i="special > ";else s="special website",i="special > "}"undefined"!=typeof prefix&&(prefix=i),void 0!==TRON.prefix&&(TRON.prefix=i);let a={},l="";void 0!==e&&(e[0].category.primaryCategory=s,l=e[0].componentInfo.componentID,a[l]=e[0]),window.adobeDataLayer.push({component:a,version:TRON.version,event:"tron event",eventInfo:{cause:"TRON implementation > "+((TRON||"").currentEventName||""),effect:TRON.prefix+t,eventAction:"trigger tron function",eventName:"error",eventPoints:0,timeStamp:(new Date).getTime(),type:"frontend component",category:{primaryCategory:(TRON||"").componentName||"",subCategory1:o,subCategory2:"TRON library"},reference:{linkedComponent:l}}})}a()&&e.apply(this,arguments)},console.info=function(){a()&&t.apply(this,arguments)},console.warn=function(){a()&&n.apply(this,arguments)}}();const a={customeEventName:"TRON:anchor",libraryName:"anchor",libraryVersion:"_v4.1.17",prefix:"nsc > ",pageExist:!0};function o(){const e=window.digitals2&&window.digitals2.tracking&&window.digitals2.tracking.api;if(void 0!==e){const t=e.getCurrentPageIndex();let n;for(let n=t;n>0;n--)if("object"==typeof e.getPageObject(n).page&&"VCO"==e.getPageObject(n).page.category.primaryCategory){t=n;break}if(n=e.getPageObject(t),void 0!==n.pageInstanceId&&""!=n.pageInstanceId&&-1==n.pageInstanceId.indexOf("need-analyzer"))return n;if(void 0!==n.component&&n&&n.component[0]&&n.component[0].category&&"stock locator"==n.component[0].category.subCategory01)return n;if(void 0!==n.component&&n&&n.component[0]&&n.component[0].componentInfo&&"digital checkout solution"==n.component[0].componentInfo.componentName)return n;if(void 0!==n.pageInstanceId&&""!=n.pageInstanceId&&n.product.length>0)return n;if(void 0!==n.pageInstanceId&&""!=n.pageInstanceId)return t&&t>0?(n=e.getPageObject(t),n):(n=e.getPageObject(0),n)}}function i(){return l([o,()=>{if("undefined"!=typeof BMWdataLayer)return JSON.parse(JSON.stringify(BMWdataLayer))},()=>{if("undefined"!=typeof mnm&&""!=((((mnm||"").mnmnsc||"").page||"").currentPage||"")&&void 0!==mnm.mnmnsc.page.currentPage.getTrackingService)return mnm.mnmnsc.page.currentPage.getTrackingService().getDigitalData()},()=>{if("undefined"!=typeof datalayer_localForms){const e=(datalayer_localForms||"").event||[];if(e.length>0)return e[e.length-1]}},()=>{if(window.digital&&window.digital.tracking&&"function"==typeof window.digital.tracking.getInstance&&void 0===window.digitalData&&window.dataLayer){const e=digital.tracking.getInstance(window.dataLayer),t=e.getCurrentPageIndex()||0,n=e.getPageObject(t);if("object"==typeof n&&0==Object.keys(n).length&&void 0!==window.dataLayer&&void 0!==window.dataLayer.activePageIndex){const e=window.dataLayer.activePageIndex||0;if(""!=((window.dataLayer||"").pages||"")&&window.dataLayer.pages.length>0)return window.dataLayer.pages[e]}return JSON.parse(JSON.stringify(n))}},()=>{if(void 0!==window.h5vco&&""!=((window.h5vco||"").digitalData||""))return window.h5vco.digitalData},()=>{if(void 0!==window.dcsDataLayer&&""!=((window.dcsDataLayer||"").pages||"")){const e=window.dcsDataLayer.activePageIndex||0;return window.dcsDataLayer.pages[e]}},()=>{if(void 0!==window.dataLayer&&void 0!==window.dataLayer.activePageIndex){const e=window.dataLayer.activePageIndex||0;return""!=((window.dataLayer||"").pages||"")&&window.dataLayer.pages.length>0?window.dataLayer.pages[e]:window.dataLayer}},()=>{if(void 0!==window.digitalData)return JSON.parse(JSON.stringify(window.digitalData))},()=>{if(window.digital&&window.digital.tracking&&"function"==typeof window.digital.tracking.getInstance&&void 0===window.dataLayer){const e=digital.tracking.getInstance(),t=e.getCurrentPageIndex()||0,n=e.getPageObject(t);return JSON.parse(JSON.stringify(n))}}],{})}function r(){try{return i()||""}catch(e){return""}}function s(e,t){try{for(var n=(e=e||"").split("."),a=r(),o=0;o<n.length&&null!=a;o++)null!=n[o]&&""!=n[o]&&(a=Array.isArray(a)&&/-[0-9]+/.test(n[o])?a[a.length-Math.abs(parseInt(n[o]))]:a[n[o]]);return"string"==typeof a&&["","na","not set","n/a","not available","not yet available","not selected","unknown"].indexOf(a.toLowerCase())>-1?t:a||t||""}catch(e){return""}}function c(e){return""!=s(e)&&void 0!==s(e)?s(e):""}function g(e){return""!=s(e)&&void 0!==s(e)?s(e):void 0}function p(e,t){for(let n of e)try{const e=n.apply(this,[t]);if(void 0!==e&&(!t||!t.isValid||t.isValid(e)))return e}catch(e){}}function l(e,t={}){return p(e,t.isValid?t:Object.assign(t,{isValid:e=>!!e}))}function d(){return l([()=>g("page.attributes.brand"),()=>window.location.hostname.indexOf("bmw-motorrad")>-1&&"motorrad",()=>window.location.hostname.indexOf("bmw")>-1&&"bmw",()=>window.location.hostname.indexOf("mini")>-1&&"mini",()=>window.location.hostname.indexOf("rolls-royce")>-1&&"rolls-royce"])||""}function m(){var e=JSON.parse(JSON.stringify(g("page.attributes")||""))||{};return e.brand=d(),e.pageTitle=l([()=>g("page.title"),()=>g("page.pageInfo.pageTitle"),()=>document.title]),e.timeZone=l([()=>g("page.attributes.timeZone")]),{attributes:JSON.parse(JSON.stringify(e)),category:{pageType:l([()=>g("page.category.pageType"),()=>g("page.category.formType"),()=>g("page.category.primaryTags")]),primaryCategory:l([()=>"NBC"==g("page.attributes.template")&&"configurator",()=>"object"==typeof g("page.category.primaryTags")&&g("page.category.primaryTags.0"),()=>void 0!==g("pageInstanceId")&&g("pageInstanceId").split("/")&&g("pageInstanceId").split("/").length>1&&"all-models"==g("pageInstanceId").split("/")[6]&&g("pageInstanceId").split("/")[6].length>8&&"showroom",()=>8==g("pageInstanceId").split("/")[6].length&&"series overview",()=>g("page.pageHier"),()=>g("page.category.subCategory01"),()=>g("page.category.primaryCategory"),()=>g("page.primarySection"),()=>g("page.category.primaryTags"),()=>"homepage"]),subCategory1:l([()=>"object"==typeof g("page.category.secondaryTags")&&g("page.category.secondaryTags.0"),()=>void 0!==g("pageInstanceId")&&g("pageInstanceId").split("/")&&g("pageInstanceId").split("/").length>1&&void 0!==g("pageInstanceId").split("/")[7]&&g("pageInstanceId").split("/")[7],()=>g("page.pageLevel2"),()=>g("page.category.subCategory01"),()=>g("page.category.purchaseReason"),()=>g("page.category.subCategory1"),()=>"content"]),subCategory2:l([()=>void 0!==g("pageInstanceId")&&g("pageInstanceId").split("/")&&g("pageInstanceId").split("/").length>1&&void 0!==g("pageInstanceId").split("/")[8]&&g("pageInstanceId").split("/")[8],()=>g("page.pageLevel3"),()=>g("page.category.subCategory02"),()=>g("page.category.subCategory2")]),subCategory3:l([()=>void 0!==g("pageInstanceId")&&g("pageInstanceId").split("/")&&g("pageInstanceId").split("/").length>1&&void 0!==g("pageInstanceId").split("/")[9]&&g("pageInstanceId").split("/")[9],()=>g("page.pageLevel4"),()=>g("page.category.subCategory03"),()=>g("page.category.subCategory3")])},pageInfo:{author:g("page.pageInfo.author"),destinationURL:l([()=>g("page.url"),()=>g("page.pageInfo.destinationUrl"),()=>g("page.pageInfo.destinationURL")]),geoRegion:l([()=>window.location.href.split("country=")[1].split("&")[0],()=>window.location.href.split("country_origin=")[1].split("&")[0],()=>g("page.pageInfo.geoRegion"),()=>g("page.pageInfo.language").indexOf("-")>-1&&g("page.pageInfo.language").split("-")[1],()=>window.location.host.indexOf("bmwusa")>-1?"US":""]),language:l([()=>g("page.pageInfo.language").slice(0,2)||(g("page.pageInfo.language").indexOf("-")>-1?g("page.pageInfo.language").split("-")[0]:window.location.host.indexOf("bmwusa")>-1?"en":"")]),pageID:l([()=>g("page.path"),()=>g("page.name"),()=>g("page.pageInfo.pageInstanceId"),()=>window.dataLayer&&window.dataLayer.pages&&(window.dataLayer.pages[0]||"").pageInstanceId,()=>g("page.pageInfo.pageID")]),pageName:l([()=>g("page.name"),()=>g("page.pageInfo.pageName")]),referringURL:l([()=>g("page.pageInfo.referringUrl"),()=>g("page.pageInfo.referringURL"),()=>document.referrer]),sysEnv:l([()=>g("page.pageInfo.devEnv"),()=>g("page.pageInfo.envWork"),()=>g("page.pageInfo.sysEnv")]),variant:l([()=>g("page.pageInfo.variant"),()=>"true"==g("page.attributes.virtualPage")?"virtual page":"real page"]),version:"acdl: "+g("page.pageInfo.version")}}}function v(e){var t=[],n={},a=[],o=e.product;if(o.length>0&&"string"!=typeof o){for(var i in o)if(void 0!==o[i]&&void 0!==o[i].productInfo){var r=o[i].productInfo.productID;void 0===r&&(r="product"+(i+1)),n[r]=o[i]}Object.keys(n).forEach((e=>a.push(e))),t.push({product:n})}if(e.page&&e.page.pageInfo&&void 0!==e.page.pageInfo.pageName&&"tbd"!=e.page.pageInfo.pageName&&("page view"==e.event[0].eventInfo.eventName&&(e.page.pageInfo.reference={},e.page.pageInfo.reference.defaultProducts=[],e.page.pageInfo.reference.defaultProducts=[].concat(a)),t.push({page:e.page})),e.page&&e.page.pageInfo&&"tbd"==e.page.pageInfo.pageName&&void 0!==s("page")&&("string"!=typeof s("page")||""==s("page"))&&void 0!==window.adobeDataLayer&&void 0!==window.adobeDataLayer.getState&&void 0===window.adobeDataLayer.getState("page")){var c={};c.page=m(),"page view"==e.event[0].eventInfo.eventName&&(c.page.pageInfo.reference={},c.page.pageInfo.reference.defaultProducts=[],c.page.pageInfo.reference.defaultProducts=[].concat(a)),t.push(c)}let g={},p=e.component[0].componentInfo.componentID;g[p]=e.component[0],t.push({component:g,version:e.version});var l={},d=e.cart;if(d&&d.item.length>0&&"string"!=typeof d){("commerce"!=e.event[0].eventInfo.eventName||"cart"!=e.event[0].eventInfo.type&&"checkout"!=e.event[0].eventInfo.type)&&""==(((e||"").cart||"").cartID||"")||(l=Object.assign({},n));var v={item:l,price:e.cart.price||{},cartID:e.cart.cartID||""};t.push({cart:v})}var h={},u=e.transaction;if(u&&u.item.length>0&&"string"!=typeof u){("commerce"==e.event[0].eventInfo.eventName&&"order"==e.event[0].eventInfo.type||""!=(((e||"").transaction||"").transactionID||""))&&(h=Object.assign({},n));var f={item:h,total:e.transaction.total||{},transactionID:e.transaction.transactionID||""};t.push({transaction:f})}var y={},b={},w=e.dealer;if(w.length>0&&"string"!=typeof w){for(var i in w)void 0!==w[i]&&void 0!==w[i].dealerInfo&&(y[w[i].dealerInfo.dealerOutletBuno]=w[i]);Object.keys(y).forEach((e=>b[e]="")),t.push({dealer:y})}if(e.user.length>0&&"string"!=typeof e.user){var I={},O=e.user;for(var i in O){var N={};if(Array.isArray(O[i].profile)&&O[i].profile.length>0)for(var D in O[i].profile)N[C=null!=O[i].profile[D].profileInfo.profileID?O[i].profile[D].profileInfo.profileID:"profile"+(D+1)]=JSON.parse(JSON.stringify(O[i].profile[D]));else if(void 0===O[i].profile&&void 0!==O[i].profileInfo&&!Array.isArray(O[i].profileInfo)){var C="profile"+(i+1);N.profile={},N.profile[C]=JSON.parse(JSON.stringify(O[i].profileInfo))}var k="user"+(i+1);I[k]=JSON.parse(JSON.stringify(O[i])),I[k].profile=JSON.parse(JSON.stringify(N))}e.user=JSON.parse(JSON.stringify(I)),t.push({user:e.user})}var T={event:"page view"==e.event[0].eventInfo.eventName?"tron page view":"tron event",eventInfo:{cause:e.event[0].eventInfo.cause,effect:e.event[0].eventInfo.effect,eventAction:e.event[0].eventInfo.eventAction,eventName:e.event[0].eventInfo.eventName,eventPoints:e.event[0].eventInfo.eventPoints,timeStamp:e.event[0].eventInfo.timeStamp,type:e.event[0].eventInfo.type,category:e.event[0].category,attributes:e.event[0].attributes,reference:{linkedComponent:p,linkedProducts:a,linkedDealers:b}}};return t.push(T),t}t.default=class{constructor(){this.detectDebugMode(),this._TronVersion="5.3.0";const e={library:function(e){e.genericEventName="TRON: adobeDataLayer generic event listener",e.customEventName=a.customeEventName,e._componentTrackingVersion=a.libraryName+""+a.libraryVersion,e.version=`TRON_${e._TronVersion}__${e._componentTrackingVersion}`},defaults:function(e){e.component={category:{componentType:"native in-page",primaryCategory:"nsc website",subCategory1:"navigation"},componentInfo:{componentName:"anchor",componentID:"anchor"},attributes:{touchpoint:"web"}},e.baseEvent={eventInfo:{cause:"default",effect:"na",eventAction:"internal click",eventName:"interaction",eventPoints:0,type:"ux"},category:{subCategory1:"",subCategory2:""},attributes:{requestedURL:""}},e.page={category:{primaryCategory:"",subCategory1:"",subCategory2:"",subCategory3:"",pageType:"tbd"},pageInfo:{pageID:"",pageName:"tbd",author:"",destinationURL:"",referringURL:"",sysEnv:"",variant:"tbd",version:"",language:"",geoRegion:""},attributes:{brand:"",timeZone:""}},e.errorMandatoryData=[],e.baseMandatoryData=["anchorName","hashName"],e.baseOptionalData=["componentDEVagency","componentPlatform","linkLocation","vehicle[n].bodyType","vehicle[n].businessDivision","vehicle[n].primaryCategory","vehicle[n].manufacturer","vehicle[n].name","vehicle[n].range","vehicle[n].productID","options[n].productID"],e.productMandatoryData=[],e.productOptionalData=[];var t=void 0!==e?e:this;t.allowedVehicleBodyType=["ca","hb","ko","co","cp","li","mp","ro","sc","st","gf","hc","sh","to","gs","ga","x","xr","gt","gl","r","rs","rr","rt","9p","9s","9u","b","s","9t"],t.allowedVehicleBusinessDivision=["new vehicle","used vehicle","after sales","other"],t.allowedVehicleCategory1=["build to order","pre-order","build to stock","young used car","demonstration car","young used bike","demonstration bike","used car (excl. yuc)","used bike (excl. yub)"],t.allowedVehicleFuelType=["b","o","d","e","g","h","m","t","x","y","z"],t.allowedVehicleHybridVersion=["beve","erex","hybr","phev","nohy"],t.allowedVehiclePrimaryCategory=["new car","used car","used bike","new bike","rental bike","rental car","owned bike","owned car"],t.allowedVehicleSeries=["1","2","3","4","5","6","7","8","x","i","m","z","clubman","5-doors","3-doors","cabrio","countryman","ad","gs","he","lt","ms","na","sp","mini"],t.allowedVehicleStatus=["available for sale","sold out","order confirmed","pre-order confirmed","contract concluded","vehicle delivered","vehicle mapped"],t.allowedVehiclecodeAG=["value should contain only 4 characters"],t.allowedVehiclecodeVG=["value should contain only 4 characters"],e.allowedComponentTypes=["standalone","native in-page","standalone iframe","in-page iframe"],e.allowedComponentPlatform=["aem > central","aem > local","non-aem > central","non-aem > local","aem","non-aem","local","central"]},events:function(e){e.events||(e.events={}),e.events=Object.assign(e.events,{anchorClick:{event:{eventInfo:Object.assign({},JSON.parse(JSON.stringify(e.baseEvent.eventInfo)),{eventAction:"internal click"})},mandatoryData:e.baseMandatoryData.concat([]),optionalData:e.baseOptionalData.concat([]),description:'trigger whenever the user <span style="color:blue">clicks</span> on the navigation. <br>\n        Please provide the following dynamic parameters.<br>\n        <ul>\n            <li>"<span style="color:blue">anchorName</span>" = the name of the navigation link , that is the visible link text </li>\n            <li>"<span style="color:blue">hashName</span>" = the value provided in the href independent if it\'s actually currently in the URL or not. eg. if the user clicked on "Fahrzeugdesign" the URL hash would be "fahrzeug-design". When the user then scrolls to "Plug-in Hybride" the hashName must be "plug-in-hybrid" and not like still visible in the URL "fahrzeug-design" </li>\n        </ul>'},anchorScroll:{event:{eventInfo:Object.assign({},JSON.parse(JSON.stringify(e.baseEvent.eventInfo)),{eventAction:"scroll"})},mandatoryData:e.baseMandatoryData.concat([]),optionalData:e.baseOptionalData.concat([]),description:'trigger whenever the user <span style="color:blue">scrolls</span> down/up on the page and the highlighted navigation area changes. <br>\n        Please provide the following dynamic parameters.<br>\n        <ul>\n            <li>"<span style="color:blue">anchorName</span>" = the name of the navigation link , that is the visible link text </li>\n            <li>"<span style="color:blue">hashName</span>" = the value provided in the href independent if it\'s actually currently in the URL or not. eg. if the user clicked on "Fahrzeugdesign" the URL hash would be "fahrzeug-design". When the user then scrolls to "Plug-in Hybride" the hashName must be "plug-in-hybrid" and not like still visible in the URL "fahrzeug-design" </li>\n        </ul>    '}})},globalDefaults:function(e){e.defaultDatalayer={component:[{category:{},componentInfo:{},attributes:{}}],event:[{category:{},eventInfo:{},attributes:{form:{},search:[],media:{},survey:{},solutionSpecific:{}}}],custom:{},page:{category:{},pageInfo:{},attributes:{}},product:[{category:{},productInfo:{},attributes:{}}],cart:{item:[{category:{},productInfo:{},price:{attributes:{}},attributes:{}}],price:{}},transaction:{total:{attributes:{}},item:[{category:{},productInfo:{},price:{attributes:{}},attributes:{}}]},user:[{segment:{},profile:[{profileInfo:{},attributes:{}}]}],dealer:[{dealerInfo:{},attributes:{}}],version:e.version},e.events||(e.events={}),e.events.error={event:{eventInfo:{eventName:"error",type:"",eventAction:"internal click",eventPoints:"0",cause:"default",effect:"na"}},custom:{errorCode:"",errorOrigin:"",errorURL:document.location.href},mandatoryData:e.errorMandatoryData.concat(["errorAction","errorMessage","errorCause","errorType","errorCode","errorOrigin"]),optionalData:e.baseMandatoryData.concat(["errorURL"]).filter((t=>!e.errorMandatoryData.includes(t))).filter((e=>!["formLeadType","formVariant","linkLocation","ctaTarget","anchorName","hashName"].includes(e))),description:'Trigger this event whenever an error occurs that prevents the user from continuing with its journey. \n                <br> All parameters that are mandatory for every other function, are optional for error events by the code (refer to parameters listed on the right). However, please provide as much information as possible eg. vehicle, options, dealer, etc. whenever it\'s available to you at the moment the error occurred.\n                <br>Please consult the <a href="https://atc.bmwgroup.net/confluence/x/1FsYrw" target="_blank">Adobe Analytics 2023 - Error Tracking confluence page</a> for further details.'},e.events=Object.assign(e.events,{activityMapClick:{event:{eventInfo:Object.assign({},JSON.parse(JSON.stringify(e.baseEvent.eventInfo)),{effect:"user clicked on an on page navigation element"})},mandatoryData:[],optionalData:["componentVersion"],description:'Trigger this event whenever the user clicks on a navigation item that does not navigate the user to a new page and hence triggers a server call.\n      <br> This is used for pure non-contextual (without vehicle, dealer, form etc context) click tracking.\n      <br>Please consult the <a href="https://atc.bmwgroup.net/confluence/x/TvwHrQ" target="_blank">Adobe Analytics 2023 - Activity Map confluence page</a> for further details.'}}),e._validErrorTypes=["backend 1st party","backend 3rd party","frontend component","user"],e._validErrorActions=e._validEventActions=["call","checkbox","component load","content closed","content opened","content visible","download","drop-down menu","first page load","form fill","internal click","outbound click","page load","radio button","rotate","item added","item removed","share","slide left","slide right","sort","suggested term","media played","media paused","media milestone reached","media stopped","email","swipe","form start intention"],e._validEventCauses=["automatic"],e.defaultValue=""}};e.library(this),e.defaults(this),e.globalDefaults(this),e.events(this);var t=Object.keys(this).filter((e=>e.includes("allowed")));for(var n in t)this[t[n]]=this[t[n]].map((e=>e.toLowerCase()));this._createPublicMethods(),this.message={}}getSupportedEvents(){var e={};for(const l in this.events){var t=JSON.parse(JSON.stringify(this.events[l].mandatoryData)),n=JSON.parse(JSON.stringify(this.events[l].optionalData)),a=Object.keys(this).map((e=>e.toLowerCase())),o=[t.sort(),n.sort()];for(var i in o)for(var r in o[i]){var s=o[i][r];s=s.indexOf("[n].")>-1?s.replace("[n].",""):s;var c=a.filter((e=>e.includes(s.toLowerCase())));if(("string"==typeof s&&1==c.length||"string"==typeof s&&c.length>1&&c[0].includes(s))&&["optionscode"].indexOf(s)<0&&Array.isArray(this[Object.keys(this)[a.indexOf(c[0])]])){var g=this[Object.keys(this)[a.indexOf(c[0])]],p="Possible Options: "+(g=g.filter((function(e){return""!==e}))).join(", ").toString();o[i][r]='<span style="color: #1000ff;font-weight: bold;" title="'+p+'">'+o[i][r]+"</span>"}}e[l]={description:this.events[l].description,"mandatory parameters":o[0].join(", <br>").toString(),"optional parameters":o[1].join(", <br>").toString()}}return e}setDebug(e){if("boolean"!=typeof e)return!1;sessionStorage.setItem("tronDebug",e),this.debug=e}detectDebugMode(){let e;null!=sessionStorage.getItem("tronDebug")&&(e="true"===sessionStorage.getItem("tronDebug")),-1!=document.location.search.indexOf("trondebug")&&(e=-1!=document.location.search.indexOf("trondebug=true"),sessionStorage.setItem("tronDebug",e)),this.setDebug(e)}_createPublicMethods(e){for(const e in this.events)this[e]=function(e){return function(t){this._processEvent(`${e}`,t)}}(e)}flattenObject(e){var t={};for(var n in e)if(e.hasOwnProperty(n))if("object"==typeof e[n]&&null!==e[n]){var a=this.flattenObject(e[n]);for(var o in a)a.hasOwnProperty(o)&&(t[n+"."+o]=a[o])}else t[n]=e[n];return t}_checkParamsPassed(e,t){t=this.flattenObject(t),t=(t=Object.keys(t)).map((function(e){return e.replace(/(.)(\d+)(.)/,"[n].")}));var n=[];for(var a in this.events)n.push.apply(n,this.events[a].mandatoryData),n.push.apply(n,this.events[a].optionalData);for(var a in n=n.filter(((e,t,n)=>n.indexOf(e)===t)),t)n.indexOf(t[a])<0&&this._throwError("o",t[a],"not-defined","")}_processEvent(e,t){void 0===t&&(t={}),TRON.currentEventName=e,TRON.prefix=a.prefix,TRON.componentName=a.libraryName||((this.component||"").componentInfo||"").componentName||"",void 0!==t&&(void 0!==t.componentName&&(TRON.componentName=t.componentName),void 0!==t.formOrigin&&(TRON.componentName=t.formOrigin),void 0!==t.componentDEVagency&&(TRON.componentName=TRON.componentName+" "+t.componentDEVagency)),TRON.version=this.version;var n=`${d()}/${l([()=>window.location.href.split("country=")[1].split("&")[0],()=>window.location.href.split("country_origin=")[1].split("&")[0],()=>g("page.pageInfo.geoRegion"),()=>g("page.pageInfo.language").indexOf("-")>-1&&g("page.pageInfo.language").split("-")[1],()=>window.location.host.indexOf("bmwusa")>-1?"US":"",()=>void 0!==t&&void 0!==t.pageGeoRegion&&t.pageGeoRegion.toLowerCase()])}_${l([()=>g("page.pageInfo.language").slice(0,2)||(g("page.pageInfo.language").indexOf("-")>-1?g("page.pageInfo.language").split("-")[0]:window.location.host.indexOf("bmwusa")>-1?"en":void 0!==t&&void 0!==t.pageLanguage?t.pageLanguage.toLowerCase():"")])}/${TRON.componentName}`;TRON.dataComponent=[{category:{componentType:this.component.category.componentType||"",primaryCategory:this.component.category.primaryCategory||"",subCategory1:this.component.category.subCategory1||""},componentInfo:{componentName:TRON.componentName,componentID:n},attributes:{touchpoint:this.component.attributes.touchpoint||""}}];var o=JSON.parse(JSON.stringify(t));this._debug("💡 event triggered:"+e,o),this._checkParamsPassed(e,o),this.message=this._loadEventData(e,t);try{this._checkmandatoryData(e,t),this.events[e].optionalData&&this._checkOptionalData(e,t)}catch(e){return!1}var i=a.prefix;this._validateProperty("componentType",this.allowedComponentTypes,e,t),this._validateProperty("componentName",this.allowedComponentNames,e,t),this._validateProperty("componentSubCat1",this.allowedComponentSubCat1,e,t),this._validateProperty("componentPlatform",this.allowedComponentPlatform,e,t),void 0!==t.componentType?this.message.component[0].category.componentType=t.componentType:this.message.component[0].category.componentType=((this.component||"").category||"").componentType||"",void 0!==t.componentSubCat1?this.message.component[0].category.subCategory1=t.componentSubCat1:this.message.component[0].category.subCategory1=((this.component||"").category||"").subCategory1||"",void 0!==t.componentVersion&&(this.message.component[0].attributes.componentVersion=["componentVersion"],delete this.message.custom.componentVersion),void 0===this.message.component[0].componentInfo&&(this.message.component[0].componentInfo={}),void 0!==t.componentName?(this.message.component[0].componentInfo.componentName=t.componentName,this.message.event[0].category.primaryCategory=t.componentName):(this.message.component[0].componentInfo.componentName=this.message.component[0].componentInfo.componentName,this.message.event[0].category.primaryCategory=this.message.component[0].componentInfo.componentName),void 0!==t.componentDEVagency&&(this.message.component[0].attributes.componentDEVagency=t.componentDEVagency),void 0!==t.componentPlatform&&(this.message.component[0].attributes.platform=t.componentPlatform);var r=void 0!==i?i:TRON.prefix,c={"con >":"configurator","stock >":"stock locator","sales >":"sales","fin >":"finance","rent >":"rental"},p=void 0!==c[r]?c[r]:((((this.message||"").component||"")[0]||"").category||"").primaryCategory||"";if(""==p||"shared > "==r||"local > "==r)if([".bmw.",".mini.",".bmw-motorrad.",".bmwusa.com","customer.bmwgroup.com"].some((e=>window.location.href.includes(e))))if([".bmw.com"].some((e=>window.location.href.includes(e)))){var v=window.location.pathname.split("/");void 0!==v[1]&&"nsc website"==(p=v[1].indexOf("-")>-1?"nsc website":"special website")&&(r="nsc > ")}else p="special website",r="special > ";else p="special website",r="special > ";void 0!==i&&(i=r),void 0!==TRON.prefix&&(TRON.prefix=r),this.message.component[0].category.primaryCategory=p,void 0!==t.hashName&&"interaction"==this.message.event[0].eventInfo.eventName&&(this.message.event[0].category.subCategory1=t.hashName),void 0!==t.linkLocation&&"interaction"==this.message.event[0].eventInfo.eventName&&(this.message.event[0].category.subCategory2=t.linkLocation),void 0!==t.anchorName&&"internal click"==this.message.event[0].eventInfo.eventAction&&(this.message.event[0].eventInfo.effect="user clicked on "+t.anchorName+" anchor navigation link"),void 0!==t.anchorName&&"scroll"==this.message.event[0].eventInfo.eventAction&&(this.message.event[0].eventInfo.effect="user scrolled to "+t.anchorName+" page section");var h=void 0!==this&&this;if(t&&t.vehicle&&void 0!==t.vehicle&&t.vehicle.length>0&&this.events[e].mandatoryData.indexOf("vehicle[n].range")>-1){var u=!1;for(var f in t.vehicle)void 0===t.vehicle[f].range&&void 0!==t.vehicle[f].rangeVG?t.vehicle[f].range=t.vehicle[f].rangeVG:void 0===t.vehicle[f].range&&void 0===t.vehicle[f].rangeVG&&(u=!0);if(u&&this.events[e].mandatoryData.indexOf("vehicle[n].range")>-1)return void this._throwError("m","vehicle[n].range","missing","")}else if(this.events[e].mandatoryData.indexOf("vehicle[n].range")>-1&&void 0===t.vehicle)return void this._throwError("m","vehicle[n].range","missing","");var y=0;function b(e,t){["codeAG","codeVG","rangeAG","rangeVG"].indexOf(e)<0&&(t="String"==typeof t?(t||"").toLowerCase():t);let n,a={bodyType:{values:h.allowedVehicleBodyType},businessDivision:{values:h.allowedVehicleBusinessDivision},category1:{values:h.allowedVehicleCategory1},codeAG:{condition:"only 4 characters"},codeVG:{condition:"only 4 characters"},fuelType:{values:h.allowedVehicleFuelType},hybridVersion:{values:h.allowedVehicleHybridVersion},primaryCategory:{values:h.allowedVehiclePrimaryCategory},series:{values:h.allowedVehicleSeries}};if(a[e]){let o=a[e];o.condition?"only 4 characters"==o.condition?n=4==t.length:"only 3 characters"==o.condition?n=3==t.length:"only 3 characters OR 4 if the last is 'E'"==o.condition&&(n=4==t.length&&"E"==t[t.length-1]||3==t.length):n=a[e].values.indexOf(t)>-1}else n=!0;return n}try{!function(e){let t=["codeAG","codeVG","rangeAG","rangeVG","name","productID","range","modelCode","modelCodeAG","mmdr","mmdrVG"];if(e&&null!=e.vehicle)for(var n=0;n<=e.vehicle.length;n++)for(var a in e.vehicle[n])t.indexOf(a)<0&&(e.vehicle[n][a]="string"==typeof e.vehicle[n][a]?e.vehicle[n][a].toLowerCase():e.vehicle[n][a])}(t),function(e,t,n,a){let o,i=n,r=[],s=Object.keys(a).map((e=>e.toLowerCase()));for(let e=0;e<i.length;e++){let n=i[e];if(n.indexOf("[n]")>-1){let e=n.split("[n]");if("vehicle"==e[0]){let i;void 0!==t[n.split("[n]")[0]]?(o=t[n.split("[n]")[0]][0][n.split("[n]")[1].replace(".","")],i=b(e[1].replace(".",""),o)):i=!1;let c=s.filter((e=>e.includes("vehicle"+n.split("[n]")[1].replace(".","").toLowerCase())));c=c.length>0?c[0]:"";let g=a[Object.keys(a)[s.indexOf(c||"")]]||[];0==i&&(r.push(n),this._throwError("m",n,"incorrect",g)),void 0===o&&this._throwError("m",n,"missing"),"string"==typeof o&&0==o.trim().length&&this._throwError("m",n,"empty",g)}}}if(r.length>0)throw""}(0,t,this.events[e].mandatoryData,this),this.events[e].optionalData&&function(e,t,n,a){let o=n,i=[],r=Object.keys(a).map((e=>e.toLowerCase()));for(let e=0;e<o.length;e++){let n,c=o[e];if(c.indexOf("[n]")>-1){let e=c.split("[n]");if("vehicle"==c.split("[n]")[0]&&t.vehicle&&t.vehicle.length>0)for(var s=0;s<=t.vehicle.length-1;s++)if(n=t[c.split("[n]")[0]][s][c.split("[n]")[1].replace(".","")],n&&""!=n&&0==b(e[1].replace(".",""),n)){let e=r.filter((e=>e.includes("vehicle"+c.split("[n]")[1].replace(".","").toLowerCase())));e=e.length>0?e[0]:"";let n=a[Object.keys(a)[r.indexOf(e)]]||[];t[c.split("[n]")[0]][s][c.split("[n]")[1].replace(".","")]="",i.push(c),this._throwError("m",c,"incorrect",n)}}}}(0,t,this.events[e].optionalData,this)}catch(e){return!1}if(this.message.product=[],void 0!==t&&t.vehicle&&t.vehicle.forEach((e=>{let t=JSON.parse(JSON.stringify(this.defaultDatalayer.product[0]));t.productInfo.productID=a&&a.vehicle&&a.vehicle.productID&&""!=a.vehicle.productID?a.vehicle.productID:(void 0!==e.productID?e.productID:"")||(void 0!==e.codeVG?e.codeVG:"")||(void 0!==e.codeAG?e.codeAG:"")||"product"+(y+1),t.productInfo.productID.indexOf("product")>-1&&(y+=1),t.productInfo.productName=a&&a.vehicle&&a.vehicle.productName&&""!=a.vehicle.productName?a.vehicle.productName:void 0!==e.name?e.name:"",t.category.productType=a&&a.vehicle&&a.vehicle.productType&&""!=a.vehicle.productType?a.vehicle.productType:void 0!==e.businessDivision?e.businessDivision:"",t.category.primaryCategory=a&&a.vehicle&&a.vehicle.primaryCategory&&""!=a.vehicle.primaryCategory?a.vehicle.primaryCategory:e.primaryCategory?e.primaryCategory:"",t.category.subCategory1=a&&a.vehicle&&a.vehicle.subCategory1&&""!=a.vehicle.subCategory1?a.vehicle.subCategory1:void 0!==e.category1?e.category1:"",t.category.subCategory2=a&&a.vehicle&&a.vehicle.subCategory2&&""!=a.vehicle.subCategory2?a.vehicle.subCategory2:void 0!==e.category2?e.category2:"",t.productInfo.manufacturer=a&&a.vehicle&&a.vehicle.manufacturer&&""!=a.vehicle.manufacturer?a.vehicle.manufacturer:void 0!==e.manufacturer?e.manufacturer:"",t.attributes.bodyType=a&&a.vehicle&&a.vehicle.bodyType&&""!=a.vehicle.bodyType?a.vehicle.bodyType:void 0!==e.bodyType?e.bodyType:"",t.attributes.modelCodeAG=a&&a.vehicle&&a.vehicle.modelCodeAG&&""!=a.vehicle.modelCodeAG?a.vehicle.modelCodeAG:void 0!==e.codeAG?e.codeAG:"",t.attributes.modelCode=a&&a.vehicle&&a.vehicle.modelCode&&""!=a.vehicle.modelCode?a.vehicle.modelCode:void 0!==e.codeVG?e.codeVG:"",t.productInfo.color=a&&a.vehicle&&a.vehicle.color&&""!=a.vehicle.color?a.vehicle.color:void 0!==e.color?e.color:"",t.attributes.motorization=a&&a.vehicle&&a.vehicle.motorization&&""!=a.vehicle.motorization?a.vehicle.motorization:void 0!==e.engine?e.engine:"",t.attributes.fuelType=a&&a.vehicle&&a.vehicle.fuelType&&""!=a.vehicle.fuelType?a.vehicle.fuelType:(e.fuelType,e.fuelType),t.attributes.gearing=a&&a.vehicle&&a.vehicle.gearing&&""!=a.vehicle.gearing?a.vehicle.gearing:void 0!==e.gearing?e.gearing:"",t.attributes.hybridVersion=a&&a.vehicle&&a.vehicle.hybridVersion&&""!=a.vehicle.hybridVersion?a.vehicle.hybridVersion:void 0!==e.hybridVersion?e.hybridVersion:"",t.attributes.mmdr=a&&a.vehicle&&a.vehicle.mmdr&&""!=a.vehicle.mmdr?a.vehicle.mmdr:(void 0!==e.rangeVG?e.rangeVG:"")||(void 0!==e.range?e.range:""),t.attributes.series=a&&a.vehicle&&a.vehicle.series&&""!=a.vehicle.series?a.vehicle.series:void 0!==e.series?e.series:"",t.attributes.modelName=a&&a.vehicle&&a.vehicle.modelName&&""!=a.vehicle.modelName?a.vehicle.modelName:void 0!==e.subSeries?e.subSeries:"",t.attributes.status=a&&a.vehicle&&a.vehicle.status&&""!=a.vehicle.status?a.vehicle.status:void 0!==e.status?e.status:"",t.attributes.productionYear=a&&a.vehicle&&a.vehicle.productionYear&&""!=a.vehicle.productionYear?a.vehicle.productionYear:void 0!==e.yearOfProduction?e.yearOfProduction:"",t.attributes.yearOfRegistration=a&&a.vehicle&&a.vehicle.yearOfRegistration&&""!=a.vehicle.yearOfRegistration?a.vehicle.yearOfRegistration:void 0!==e.yearOfRegistration?e.yearOfRegistration:"",t.attributes.encVIN=a&&a.vehicle&&a.vehicle.encVIN&&""!=a.vehicle.encVIN?a.vehicle.encVIN:void 0!==e.encVIN?e.encVIN:"",this.message.product.push(t)})),void 0!==t&&t.componentVersion&&(this.message.component[0].attributes.componentVersion=t.componentVersion),this.message.event[0].category.primaryCategory=this.message.component[0].componentInfo.componentName,void 0!==t&&(this.message.component[0].componentInfo.componentID=d(),this.message.component[0].componentInfo.componentID+=" > "+((void 0!==t.pageGeoRegion?t.pageGeoRegion:"")||g("page.pageInfo.geoRegion")||""),this.message.component[0].componentInfo.componentID+=" > "+((void 0!==t.componentName?t.componentName:"")||this.message.component[0].componentInfo.componentName),"form"==this.message.event[0].eventInfo.eventName&&(this.message.component[0].componentInfo.componentID+=" "+(void 0!==t.formType?t.formType:""))),void 0!==this.message.event[0].eventInfo.effect&&(this.message.event[0].eventInfo.effect=(i||"")+this.message.event[0].eventInfo.effect,this.message.event[0].eventInfo.timeStamp=this.message.event[0].timeStamp,delete this.message.event[0].timeStamp),"aem page loaded"!=(((window.adobeDataLayer||"")[0]||"").event||"")&&"page view"!=this.message.event[0].eventInfo.eventName&&(void 0===s("page")||"string"==typeof s("page")&&""!=s("page")||(this.message.page=m())),this.message.product.length>0){var w=[];for(var f in this.message.product)if(void 0!==this.message.product[f]&&void 0!==this.message.product[f].productInfo){var I=this.message.product[f].productInfo.productID;void 0===I&&(I="product"+(f+1)),w.push(I)}this.message.page.pageInfo.reference={},this.message.page.pageInfo.reference.defaultProducts=[],this.message.page.pageInfo.reference.defaultProducts=[].concat(w)}if(void 0!==t&&void 0===t.user)if(void 0!==window.adobeDataLayer&&void 0!==window.adobeDataLayer.getState){var O=window.adobeDataLayer.getState();if(void 0!==O.user&&Object.keys(O.user).length>0)for(var f in this.message.user=[],O.user)this.message.user.push(O.user[f])}else void 0!==s("user")&&"string"!=typeof s("user")&&(this.message.user=s("user"));if(void 0!==t&&void 0===t.dealer)if(void 0!==window.adobeDataLayer&&void 0!==window.adobeDataLayer.getState){var N=window.adobeDataLayer.getState();if(void 0!==N.dealer&&Object.keys(N.dealer).length>0)for(var f in this.message.dealer=[],N.dealer)this.message.dealer.push(N.dealer[f])}else void 0!==s("dealer")&&"string"!=typeof s("dealer")&&(this.message.dealer=s("dealer"));"error"==this.message.event[0].eventInfo.eventName&&(this.message.event[0].eventInfo.effect=void 0!==t.errorMessage?(i||"")+t.errorMessage:"",void 0!==t.errorAction&&(this.message.event[0].eventInfo.eventAction=t.errorAction),void 0!==t.errorCause&&(this.message.event[0].eventInfo.cause=t.errorCause),void 0!==t.errorType&&(this.message.event[0].eventInfo.type=t.errorType),this.message.event[0].category.primaryCategory=t.componentName||this.message.component[0].componentInfo.componentName,void 0!==t.errorCode&&(this.message.event[0].category.subCategory1=t.errorCode),void 0!==t.errorOrigin&&(this.message.event[0].category.subCategory2=t.errorOrigin),void 0!==t.errorURL&&(this.message.event[0].attributes.requestedURL=t.errorURL),delete this.message.event[0].type,delete this.message.event[0].action,delete this.message.event[0].cause,delete this.message.event[0].effect),t.eventCause&&null!=t.eventCause&&(this.message.event[0].eventInfo.cause=t.eventCause),void 0===t.eventAction||"item added"!=this.message.event[0].eventInfo.eventAction&&"item removed"!=this.message.event[0].eventInfo.eventAction&&"form start intention"!=this.message.event[0].eventInfo.eventAction?void 0!==t.eventAction&&"item added"!==this.message.event[0].eventInfo.eventAction&&"item removed"!==this.message.event[0].eventInfo.eventAction&&"form start intention"!==this.message.event[0].eventInfo.eventAction&&(this.message.event[0].eventInfo.eventAction=t.eventAction):this._throwError("o",this.message.event[0].eventInfo.eventAction,"specific case",""),this.message.event[0].eventInfo.effect=this.message.event[0].eventInfo.effect.toLowerCase(),this.message.component[0].componentInfo.componentID=(((this.message.page||"").attributes||"").brand||"")+"/"+(((this.message.page||"").pageInfo||"").geoRegion||"")+"_"+(((this.message.page||"").pageInfo||"").language||"")+"/"+this.message.component[0].componentInfo.componentName,void 0!==this.message.page.pageInfo.pageID&&(this.message.page.pageInfo.pageID="/"+(this.message.page.category.pageType||"")+"/"+this.message.page.attributes.brand+"/"+this.message.page.pageInfo.geoRegion+"/"+this.message.page.pageInfo.language+"/"+this.message.page.category.primaryCategory+"/",void 0!==this.message.page.category.subCategory1&&""!=this.message.page.category.subCategory1&&(this.message.page.pageInfo.pageID=this.message.page.pageInfo.pageID+this.message.page.category.subCategory1+"/"),void 0!==this.message.page.category.subCategory2&&""!=this.message.page.category.subCategory2&&(this.message.page.pageInfo.pageID=this.message.page.pageInfo.pageID+this.message.page.category.subCategory2+"/"),void 0!==this.message.page.category.subCategory3&&""!=this.message.page.category.subCategory3&&(this.message.page.pageInfo.pageID=this.message.page.pageInfo.pageID+this.message.page.category.subCategory3+"/"),this.message.page.pageInfo.pageID=this.message.page.pageInfo.pageID+(void 0!==this.message.page.pageInfo.pageName&&this.message.page.pageInfo.pageName.indexOf(">")>-1&&this.message.page.pageInfo.pageName.split(" > ").length>0&&this.message.page.pageInfo.pageName.split(" > ")[1]||this.message.page.pageInfo.pageName)),this._debug("💲 payload created",this.message),this._sendMessage()}_checkmandatoryData(e,t){let n,a=this.events[e].mandatoryData,o=!0,i="";for(let e=0;e<a.length;e++){let r,s=a[e];if(s.indexOf("[n]")>-1){let e=s.split("[n]");i=e[1].replace(".",""),r=t[e[0]]&&t[e[0]][0][i]}else r=t[s];if(void 0===r)switch(s){case"componentType":r=this.component.category.componentType;break;case"componentName":r=this.component.componentInfo.componentName;break;case"componentSubCat1":r=this.component.category.subCategory01}n=this._checkValidValue("mandatory",s,i,r),0==n&&(o=!1)}if(0==o)throw new SyntaxError;return!0}_checkOptionalData(e,t){let n,a=this.events[e].optionalData,o=!0,i="";for(let e=0;e<a.length;e++){let r,s=a[e];if(s.indexOf("[n]")>-1){let e=s.split("[n]");t[e[0]]&&t[e[0]].length>0&&(i=e[1].replace(".",""),r=t[e[0]][0][i],r&&""==r&&errArrayVal.push(s))}else r=t[s];void 0===r&&void 0===t[s]||(n=this._checkValidValue("optional",s,i,r),0==n&&(s.indexOf("[n]")>-1?t[s.split("[n]")[0]][0][s.split("[n]")[1].replace(".","")]="":t[s]="",o=!1))}return!0}_checkValidValue(e,t,n,a){let o=!0,i=Object.keys(this).map((e=>e.toLowerCase()));n=""!=n&&t.indexOf("[n]")>-1?t.replace("[n].",""):t;let r=i.filter((e=>e.includes(n.toLowerCase()))),s="object"==typeof this[Object.keys(this)[i.indexOf(r[0])]]?this[Object.keys(this)[i.indexOf(r[0])]]:[];if(s=s.filter((function(e){return""!==e})),(void 0===(a="string"==typeof a?(a||"").toLowerCase():a)||null==a)&&"mandatory"==e){if(["vehicle[n].range"].indexOf(t)>-1)return!0;this._throwError("m",t,"missing",""),o=!1}if("string"==typeof a&&0==a.trim().length&&"mandatory"==e&&(this._throwError("m",t,"empty",s),o=!1),Array.isArray(s)&&s.length>0&&!s.includes(a)&&("string"==typeof a&&a.trim().length>0||null==a||""==a||void 0===a)&&1==o){if(t.indexOf("vehicle")>-1&&(t=t.split(".")[1],["codeAG","codeVG","range","rangeVG"].indexOf(t)>-1))return!0;if(["formLeadType","formComChannel","dealer[n].selectionState","options[n].code","options[n].codeVG","options[n].category1","pageGeoRegion","pageLanguage","vehicle[n].range","pageSubCat1"].indexOf(t)>-1&&void 0!==a)return!0;if(1==s.length&&"value should be numeric"==s[0])return!0;"mandatory"==e?(this._throwError("m",t,"incorrect",s),o=!1):"optional"==e&&(this._throwError("o",t,"incorrect",s),o=!1)}return o}_loadEventData(e,t){const n=Object.assign({},JSON.parse(JSON.stringify(this.defaultDatalayer)));n.component[0]=Object.assign({},JSON.parse(JSON.stringify(this.component)));const o=JSON.parse(JSON.stringify(this.defaultDatalayer.event[0])),i=JSON.parse(JSON.stringify(this.baseEvent)),r=JSON.parse(JSON.stringify(this.events[e].event));n.event[0]=[o,i,r].reduce(this._deepMerge.bind(this),{}),n.event[0].timeStamp=(new Date).getTime(),a.pageExist&&void 0!==n.page&&(this.events[e].page?n.page=Object.assign({},JSON.parse(JSON.stringify(this.page)),JSON.parse(JSON.stringify(this.events[e].page))):n.page=Object.assign({},JSON.parse(JSON.stringify(this.page)))),a.projConditionCheck&&a.projectCondition(this,e,t),this.events[e].custom=this.events[e].custom?this.events[e].custom:{};const s=JSON.parse(JSON.stringify(this.baseCustom||{})),c=JSON.parse(JSON.stringify(this.events[e].custom));return n.custom=[s,c].reduce(this._deepMerge.bind(this),{}),n.version="tron_"+this._TronVersion+"__"+this._componentTrackingVersion,n}_throwError(e,t,n,a,o){const i="m"===e?"Incorrect TRON implementation: ⛔ ":"Incorrect TRON implementation: ⚠️ ";let r="";switch(a=""!=a?a.reduce(((e,t)=>`${e},${t}`)):a,n){case"not-defined":r+=`Parameter ${t} not defined in the library, hence this value cannot be tracked. The remaining data will be tracked. Please remove this parameter. ${o||""}`;break;case"specific case":["item added","item removed","form start intention"].includes(t)&&(r+=`since eventInfo.eventAction = 'item added' or 'item removed' or 'form start intention', it cannot be overwritten with eventAction value ${o||""}`);break;case"missing":r+=`parameter is missing, hence this event cannot be tracked. Please provide the parameter ${o||""}: ${t}`;break;case"empty":r+=`${t} value is empty, hence this event cannot be tracked. Pick a standard value Please provide a valid value ${o||""}: ${a}`;break;case"incorrect":r+=`${t} value is incorrect, hence this value cannot be tracked. The remaining data will be tracked. Pick a standard value ${o||""}: ${a}`;break;case"incorrect-numeric":r+=`${t} value is incorrect, hence this value cannot be tracked. Please send a numeric value ${o||""}`;break;case"eventMessage":r+=`custom event created was not sent, hence this event cannot be tracked. Please check the error ${o||""}:`;break;case"nonValidFunction":r+=`this function ${t} does not exist, hence this event cannot be tracked. Please make sure to use a correct reference name. ${o||""} Error Details: ${a}`}r=i+r,"m"===e?console.error(r):"o"==e&&console.warn(r)}_validateProperty(e,t,n,a,o=!1){if(a&&a[e]&&null!=typeof a[e]){let i=a[e];if(!t.includes(i)){if(this.events[n].mandatoryData.indexOf(e)>-1||1==o)return void this._throwError("m",e,"incorrect",t);this._throwError("o",e,"incorrect",t),a[e]=""}}}_debug(e,t){this.debug&&console.info(this.version,"\r\n",e,"\r\n",t)}_sendMessage(){this._debug("⌛ sending data..."),this.message.component[0].category.componentType.indexOf("iframe")>-1?this._sendPostMessage():(this._sendCustomEvent(),this._sendGenericEvent()),this.message={}}_sendCustomEvent(){let e=!1;try{e=new CustomEvent(this.customEventName,JSON.parse(JSON.stringify({detail:this.message}))),window.dispatchEvent(e)}catch(e){return this._throwError("m","custom event","eventMessage",[e]),!1}this._debug("✅ custom event successfully sent",e)}_sendGenericEvent(){let e=!1;try{e=new CustomEvent(this.genericEventName,JSON.parse(JSON.stringify({detail:this.message}))),window.dispatchEvent(e)}catch(e){return this._throwError("m","custom event","eventMessage",[e]),!1}this._debug("✅ generic event successfully sent",e)}_sendPostMessage(){let e=!1;try{var t=v(this.message);e=JSON.parse(JSON.stringify({methodName:"TRON: postMessage",detail:t,type:"TRON: generic iframe event listener"})),window.top.postMessage(JSON.stringify(e),"*")}catch(e){return this._throwError("m","custom event","eventMessage",[e]),!1}this._debug("✅ postmessage successful sent",e)}_deepMerge(e,t){return Object.entries(t).forEach((([t,n])=>{n&&"object"==typeof n?this._deepMerge(e[t]=e[t]||{},n):e[t]=n})),e}},window.onerror=function(){if(arguments.length>0&&"string"==typeof arguments[0]&&arguments[0].indexOf("Uncaught TypeError: ")>-1&&arguments[0].indexOf("not a function")>-1){var e=arguments[0].split("Uncaught TypeError: ")[1].split("is not a function")[0];return console.error("Incorrect TRON implementation: ⛔ this function "+e+" does not exist , hence this event cannot be tracked. Please make sure to use a correct reference name!","\n","Error occurred at:",arguments),!0}return!1},TRON.isInitialized||(window.addEventListener("TRON: adobeDataLayer generic event listener",(function(e){window.tronDetailDL=e.detail,window.adobeDataLayer=window.adobeDataLayer||[];for(var t=v(tronDetailDL),n={},a=0;a<t.length;a++)for(var o=t[a],i=Object.keys(o),r=0;r<i.length;r++){var s=i[r];n[s]=o[s]}window.adobeDataLayer.push(n)})),TRON.isInitialized=!0)},690:function(e,t,n){var a,o;a=[t,n(579)],void 0===(o=function(e,n){"use strict";var a;Object.defineProperty(e,"__esModule",{value:!0}),t.default=void 0;var o=(n=(a=n)&&a.__esModule?a:{default:a}).default;t.default=o}.apply(t,a))||(e.exports=o)}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,n),i.exports}return n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(690)}()}));